---
import Layout from "../../../layouts/Layout.astro";
import Header from "../../../components/Header.astro";
import Footer from "../../../components/Footer.astro";
import { getCollection } from "astro:content";
import { SITE } from "../../../config/site.mjs";

const entries = (await getCollection("tech"))
  .filter((entry) => !entry.data.draft)
  .sort((a, b) => b.data.date.valueOf() - a.data.date.valueOf());
---

<Layout
  title={`Tech Blog | ${SITE.title}`}
  description="技術ブログ一覧"
  canonicalURL={`${SITE.url}/blog/tech`}
>
  <Header />
  <main id="main-content" class="mx-auto max-w-3xl px-6 py-12">
    <header class="mb-8">
      <h1 class="text-3xl font-semibold text-gray-900">技術ブログ</h1>
      <p class="mt-2 text-gray-600">開発メモや技術的な話題。</p>
    </header>

    {entries.length === 0 ? (
      <p class="text-gray-600">まだ記事がありません。</p>
    ) : (
      <ul class="space-y-6">
        {entries.map((entry) => (
          <li class="rounded-2xl border border-gray-200 bg-white p-6 shadow-sm">
            <p class="text-sm text-gray-500">
              <time datetime={entry.data.date.toISOString()}>
                {entry.data.date.toLocaleDateString("ja-JP")}
              </time>
            </p>
            <h2 class="mt-2 text-xl font-semibold text-gray-900">
              <a class="hover:underline" href={`/blog/tech/${entry.slug}/`}>
                {entry.data.title}
              </a>
            </h2>
            {entry.data.description && (
              <p class="mt-2 text-gray-600">{entry.data.description}</p>
            )}
            {entry.data.tags && entry.data.tags.length > 0 && (
              <ul class="mt-3 flex flex-wrap gap-2">
                {entry.data.tags.map((tag) => (
                  <li class="text-xs rounded-full bg-gray-100 px-2 py-1 text-gray-600">
                    {tag}
                  </li>
                ))}
              </ul>
            )}
          </li>
        ))}
      </ul>
    )}
  </main>
  <Footer />
</Layout>
